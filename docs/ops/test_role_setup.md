# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Go2Asia

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–ø–æ—Å–æ–± –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ Clerk –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ JWT —Ç–æ–∫–µ–Ω–µ.

> **–í–∞–∂–Ω–æ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –≤ –∫–∞–ø—Å—É–ª–µ (`capsules/**`) —è–≤–ª—è–µ—Ç—Å—è read-only –ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–º –∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏. –ë–æ–µ–≤–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ –≠—Ç–∞–ø–µ 0.6 –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `apps/**`.

---

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### ‚úÖ –£–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ:
- [x] –†–æ–ª—å `admin` –Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é `siberialife2021@gmail.com` –≤ Public metadata
- [x] Customize Session Token –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ Clerk Dashboard —Å claim `role: "{{user.public_metadata.role || 'spacer'}}"`

---

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ JWT —Ç–æ–∫–µ–Ω (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±)

–ï—Å–ª–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –µ—â—ë –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–æ–ª—å —á–µ—Ä–µ–∑ backend API.

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å JWT —Ç–æ–∫–µ–Ω –∏–∑ Clerk Dashboard

1. –û—Ç–∫—Ä–æ–π—Ç–µ [Clerk Dashboard](https://dashboard.clerk.com/)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Users** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `siberialife2021@gmail.com`
3. –í —Ä–∞–∑–¥–µ–ª–µ **Sessions** –Ω–∞–π–¥–∏—Ç–µ –∞–∫—Ç–∏–≤–Ω—É—é —Å–µ—Å—Å–∏—é
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Session Token** (JWT)

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: –ß–µ—Ä–µ–∑ Clerk API**
```bash
curl -X POST https://api.clerk.com/v1/sessions \
  -H "Authorization: Bearer YOUR_CLERK_SECRET_KEY" \
  -H "Content-Type: application/json" \
  -d '{"user_id": "user_34vD_6k5RwIZ59"}'
```

### –®–∞–≥ 2: –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å JWT —Ç–æ–∫–µ–Ω

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [jwt.io](https://jwt.io/) –¥–ª—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–∫–µ–Ω–∞:

1. –û—Ç–∫—Ä–æ–π—Ç–µ [jwt.io](https://jwt.io/)
2. –í—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ –ø–æ–ª–µ **"Encoded"**
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–µ `role` –≤ **Payload**

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "sub": "user_34vD_6k5RwIZ59",
  "role": "admin",
  "iat": 1234567890,
  "exp": 1234567890,
  ...
}
```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:**
- ‚úÖ –ü–æ–ª–µ `role` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ payload
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏–µ `role` —Ä–∞–≤–Ω–æ `"admin"` (–¥–ª—è –≤–∞—à–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- ‚úÖ –ü–æ–ª–µ `sub` —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∞—à user ID

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

–†–æ–ª—å —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π, –µ—Å–ª–∏:

1. ‚úÖ –í JWT —Ç–æ–∫–µ–Ω–µ (payload) –µ—Å—Ç—å –ø–æ–ª–µ `role` —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º `"admin"` (–¥–ª—è –≤–∞—à–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
2. ‚úÖ –ó–Ω–∞—á–µ–Ω–∏–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å `publicMetadata.role` –≤ Clerk Dashboard
3. ‚úÖ –¢–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω (–Ω–µ –∏—Å—Ç—ë–∫ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è)

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: `role` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ JWT —Ç–æ–∫–µ–Ω–µ

**–ü—Ä–∏—á–∏–Ω–∞:** Customize Session Token –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Clerk Dashboard ‚Üí **Sessions** ‚Üí **Customize session token**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Claims editor –µ—Å—Ç—å: `{ "role": "{{user.public_metadata.role || 'spacer'}}" }`
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω (–≤—ã–π–¥–∏—Ç–µ –∏ –≤–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ –≤ Clerk Dashboard –∏–ª–∏ —á–µ—Ä–µ–∑ API)

### –ü—Ä–æ–±–ª–µ–º–∞: `role` –µ—Å—Ç—å, –Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ `"spacer"` –≤–º–µ—Å—Ç–æ `"admin"`

**–ü—Ä–∏—á–∏–Ω–∞:** –†–æ–ª—å –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –≤ Public metadata –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Clerk Dashboard ‚Üí **Users** ‚Üí –≤–∞—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí **Public metadata**
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –µ—Å—Ç—å –ø–æ–ª–µ `role: "admin"`
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω (—Ä–æ–ª—å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–æ–≤–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–æ–∫–µ–Ω –∏—Å—Ç—ë–∫

**–ü—Ä–∏—á–∏–Ω–∞:** Session token –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è (7 –¥–Ω–µ–π –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º).

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü–æ–ª—É—á–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ Clerk Dashboard –∏–ª–∏ API
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Session lifetime –≤ Clerk Dashboard

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- **–†–æ–ª—å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ç–æ–∫–µ–Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–æ–≤–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** (–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö)
- –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
- –í production –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ production Clerk –∫–ª—é—á–∏ (`pk_live_...` –∏ `sk_live_...`)
- **–ö–∞–ø—Å—É–ª–∞ (`capsules/**`) —è–≤–ª—è–µ—Ç—Å—è read-only –ø—Ä–æ—Ç–æ—Ç–∏–ø–æ–º** ‚Äî –±–æ–µ–≤–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ –≠—Ç–∞–ø–µ 0.6 –≤ `apps/**`

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–∏ —á–µ—Ä–µ–∑ JWT —Ç–æ–∫–µ–Ω:

- ‚úÖ **Phase 0.5 –∑–∞–≤–µ—Ä—à—ë–Ω** ‚Äî —Ä–æ–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã
- ‚û°Ô∏è **Phase 0.6** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –±–æ–µ–≤–æ–≥–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –≤ `apps/go2asia-pwa-shell` —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Clerk –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–æ–ª–µ–π

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-12-12  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-12-12

